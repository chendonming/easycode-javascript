<%# 这是前端vue ejs模板 20201205进阶版 -%>
<%_ function filterSelect() { return insertList.filter(v => v.component === 'select').map(v => v.Field + 'List') } -%>
<template>
  <div>
    <el-form :model="searchForm" inline>
      <%_ searchList.forEach(function(data) { -%>
        <el-form-item label="<%=data.Comment %>" prop="<%=_.camelCase(data.Field) %>">
        <%_ if(data.component === 'input') { -%>
          <el-input v-model="searchForm.<%=_.camelCase(data.Field) %>"></el-input>
        <%_ }-%>
        <%_ if(data.component === 'text') { -%>
          <el-input v-model="searchForm.<%=_.camelCase(data.Field) %>" type="textarea" :row="3"></el-input>
        <%_ }-%>
        <%_ if(data.component === 'select') { -%>
          <el-select v-model="searchForm.<%=_.camelCase(data.Field) %>">
            <el-option v-for="(item,index) in <%=_.camelCase(data.Field) %>List"
              :key="index"
              :label="item.dictionaryName"
              :value="item.code">
            </el-option>
          </el-select>
        <%_ }-%>
        <%_ if(data.component === 'date') { -%>
          <el-date-picker
            v-model="searchForm.<%=_.camelCase(data.Field) %>"
            type="date"
            value-format="yyyy-MM-dd"
            placeholder="选择日期">
          </el-date-picker>
        <%_ }-%>
        <%_ if(data.component === 'datetime') { -%>
          <el-date-picker
            v-model="searchForm.<%=_.camelCase(data.Field) %>"
            type="datetime"
            value-format="yyyy-MM-dd HH:mm:ss"
            placeholder="选择日期时间">
          </el-date-picker>
        <%_ }-%>
        <%_ if(data.component === 'color') { -%>
          <el-color-picker v-model="searchForm.<%=_.camelCase(data.Field) %>"></el-color-picker>
        <%_ }-%>
        <%_ if(!data.component) { -%>
          <el-input v-model="searchForm.<%=_.camelCase(data.Field) %>"></el-input>
        <%_ }-%>
        </el-form-item>
      <%_ }); -%>
    </el-form>
    <el-table :data="tableData">
      <%_ queryList.forEach(function(data) { -%>
        <el-table-column label="<%=data.Comment %>" prop="<%=_.camelCase(data.Field) %>"></el-table-column>
      <%_ }) -%>
    </el-table>

    <el-dialog title="新增" :visible.sync="visible">
      <el-form
        :model="addForm"
        ref="addForm"
        label-width="100px"
        :rules="rule"
        class="demo-form-inline"
      >
        <%_ insertList.forEach(function(data){ -%>
          <el-col :span="12">
            <el-form-item label="<%=data.Comment %>" prop="<%=_.camelCase(data.Field) %>">
            <%_ if(data.component === 'input') { -%>
              <el-input v-model="addForm.<%=_.camelCase(data.Field) %>"></el-input>
            <%_ }-%>
            <%_ if(data.component === 'text') { -%>
              <el-input v-model="addForm.<%=_.camelCase(data.Field) %>" type="textarea" :row="3"></el-input>
            <%_ }-%>
            <%_ if(data.component === 'date') { -%>
              <el-date-picker
                v-model="addForm.<%=_.camelCase(data.Field) %>"
                type="date"
                value-format="yyyy-MM-dd"
                placeholder="选择日期">
              </el-date-picker>
            <%_ }-%>
            <%_ if(data.component === 'datetime') { -%>
              <el-date-picker
                v-model="addForm.<%=_.camelCase(data.Field) %>"
                type="datetime"
                value-format="yyyy-MM-dd HH:mm:ss"
                placeholder="选择日期时间">
              </el-date-picker>
            <%_ }-%>
            <%_ if(data.component === 'color') { -%>
              <el-color-picker v-model="addForm.<%=_.camelCase(data.Field) %>"></el-color-picker>
            <%_ }-%>
            <%_ if(data.component === '') { -%>
              <el-input v-model="addForm.<%=_.camelCase(data.Field) %>"></el-input>
            <%_ }-%>
            </el-form-item>
          </el-col>
        <%_ }) -%>
      </el-form>
    </el-dialog>
  </div>
</template>

<script>
  export default {
    data() {
      return {
        searchForm: {
        <%_ searchList.forEach(function(data) { -%>
          <%=_.camelCase(data.Field) %>: '',
        <%_ }); -%>
        },
        tableData: [],
        visible: false,
        addForm: {
        <%_ insertList.forEach(function(data) { -%>
          <%=_.camelCase(data.Field) %>: '',
        <%_ }); -%>
        }
        <%_ filterSelect().forEach(data => { -%>
        <%=_.camelCase(data) %>: [],
        <%_ }); -%>
      }
    },
    created() {
      // 接口获取tableData
    }
  }
</script>
